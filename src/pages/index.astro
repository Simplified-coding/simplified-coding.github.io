---
import Layout from "../layouts/Layout.astro";
import RoadMap from "../assets/RoadMap.svg"
import {getEntry} from "astro:content";

const courses = (await getEntry("lessons", "courses")).data.courses.map(c => c.slug)
---

<Layout>
  <br/>
  <div class="d-flex justify-content-center" style="color: white">
    <div>
      <h1>
        Καλωσήρθατε στο <strong class="text-decoration-underline"
      >Simplified Coding</strong
      >
      </h1>
    </div>
  </div>
  <br/>
  <div id="doc-body"></div>
  <div id="doc-body-mobile"></div>
  <div class="d-flex justify-content-center">
    <div style="background-color: #A46AC9; width: 60vw; height: 80vh">
      <object id="svg-roadmap" type="image/svg+xml" style="width: inherit; height: inherit; border:1px solid black; "
              data={RoadMap}/>
    </div>
  </div>
  <br/>
  <br/>

  <script>
    import svgPanZoom from "svg-pan-zoom"

    window.trigger = function () {
      svgPanZoom('#svg-roadmap', {
        zoomEnabled: true,
        controlIconsEnabled: true,
        mouseWheelZoomEnabled: false
      });
    };
  </script>

  <script data-courses={JSON.stringify(courses)} id="svg">


    function goToCourse(course) {
      window.location.pathname = `/lessons/view/${course}`
    }

    window.onload = () => {
      window.trigger()

      JSON.parse(document.getElementById("svg").getAttribute("data-courses")).forEach(c => {
        console.log(c)
        document.getElementById("svg-roadmap").contentDocument.children[0].getElementById(`svg-${c}-completed`).style = "display: none"

        document.getElementById("svg-roadmap").contentDocument.children[0].getElementById(`svg-${c}`).onclick = () => goToCourse(c)
        document.getElementById("svg-roadmap").contentDocument.children[0].getElementById(`svg-${c}-text`).onclick = () => goToCourse(c)
      })
    }
  </script>
</Layout>
